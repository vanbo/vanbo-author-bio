!function(e){e(document).ready(function(){a.init()});var a={addImageButtonWrapper:{},frameTitle:"",imageId:"",init:function(){a.addImageButtonWrapper=e(".vabio-add-images"),a.removeImageWrapper=e("#vabio-remove-image-wrap"),a.addImagePreviewWrapper=e(".vabio-image-preview"),a.imageIdEl=e("#vabio-avatar-image-id"),a.frameTitle=e(".vabio-add-image").data("title"),a.loadAddImage(),a.loadRemoveImage()},uploadImage:{get:function(){return wp.media.view.settings.post.vabioUserImageId},set:function(e){var i=wp.media.view.settings;i.post.vabioUserImageId=e.id,i.post.vabioUserAvatarSrc=e.url,i.post.vabioUserImageId&&i.post.vabioUserAvatarSrc&&(a.addImagePreviewWrapper.find("img").attr("src",i.post.vabioUserAvatarSrc),a.removeImageWrapper.show(),a.imageIdEl.val(i.post.vabioUserImageId)),a.uploadImage.frame().close()},frame:function(){return this._frame?this._frame:(this._frame=wp.media({library:{type:"image"},multiple:!1,title:a.frameTitle}),this._frame.on("open",function(){var a=e("#vabio-avatar-image-id").val(),i=this.state().get("selection"),t=wp.media.attachment(a);t.fetch(),i.add(t?[t]:[])},this._frame),this._frame.state("library").on("select",this.select),this._frame)},select:function(i){var t=this.get("selection").single(),r={id:t?t.id:""};r.id&&(r.url=0<t.sizes?t.sizes.medium.url:e("div.attachment-info").find("img").attr("src")),a.uploadImage.set(r)}},loadAddImage:function(){"undefined"!=typeof wp&&void 0!==wp.media?a.addImageButtonWrapper.on("click",".vabio-add-image",function(e){e.preventDefault(),e.stopPropagation(),a.imageId="",a.uploadImage.frame().open()}):a.addImageButtonWrapper.hide()},loadRemoveImage:function(){"undefined"!=typeof wp&&void 0!==wp.media?a.removeImageWrapper.on("click","#vabio-remove-image",function(e){e.preventDefault(),e.stopPropagation(),a.imageId="",a.addImagePreviewWrapper.find("img").remove(),a.addImagePreviewWrapper.html(vabio_params.defaultImage),a.imageIdEl.val(""),a.removeImageWrapper.hide()}):a.removeImageWrapper.hide()}}}(jQuery);